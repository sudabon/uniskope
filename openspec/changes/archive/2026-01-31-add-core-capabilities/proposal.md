# 変更: Uniskope v0.1 コア機能の追加

## なぜ

UniskopeがSaaSコントロールプレーンとして機能するには、基盤となる機能が必要です。この提案では、インディーハッカーが外部決済プロバイダーに依存せずにSaaS運営のSingle Source of Truth（SSOT）を維持できるようにするコアシステムコンポーネントを定義します。

## 何を変更するか

この提案では5つのコア機能を導入します：

1. **Webhook取り込み** - 決済SaaSプロバイダーからの生Webhookペイロードを受信・保存
2. **イベントストア** - すべてのイベントの不変・追記専用ストレージ
3. **状態リゾルバー** - イベント履歴から現在の正規化された状態を導出
4. **ダッシュボード** - 運用可視化のための読み取り専用UI
5. **Public API** - アプリケーション連携用のクエリインターフェース

## 影響範囲

- 影響するSpec: 新規機能（既存Specなし）
- 影響するコード: 初期実装全体
  - データベーススキーマ（events, users, subscriptions, entitlements, state_transitions）
  - APIエンドポイント
  - Webhookハンドラー
  - 状態解決ロジック
  - ダッシュボードUI

## 成功基準

- [ ] Stripe/Lemon Squeezy/PaddleからのWebhookを受信・保存できる
- [ ] イベントが完全な監査証跡とともに不変に保存される
- [ ] 現在のサブスクリプション/エンタイトルメント状態をリアルタイムでクエリできる
- [ ] ダッシュボードにアクティブユーザー、サブスクリプション、最近のイベントが表示される
- [ ] Public APIが許容可能なレイテンシで読み取り操作に応答する

## 関連ドキュメント

- `docs/SERVICE_SPEC.md` - オリジナルのサービス仕様
- `REQUIREMENT.md` - プロジェクト要件と非スコープ
